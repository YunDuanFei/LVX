import numpy as np
import math
import matplotlib.pyplot as plt
from matplotlib import cm
import seaborn as sns
from palettable.cartocolors.sequential import DarkMint_4
# sns.set_style("dark")
plt.rcParams['font.family'] = ['Times New Roman']
plt.rcParams['font.size'] = 14


def dff(y,t) :
    Da, De = 0.2, 0.2
    P0, Q0 = 0.3, -0.16
    R, X = 1.2, 1.1
    G, B = 1.2/(R**2+X**2), -1.1/(R**2+X**2)
    Y = math.sqrt(G**2+B**2)
    E0 = 1
    Ta, Te = 1.2, 12
    Es, Ds = 1.05, math.pi/6
    x1,x2 = y
    dydt =[(Da*(P0-(x2+Es)**2*G+(x2+Es)*E0*Y*np.cos(x1+Ds-math.atan(B/G)))-x1)/Ta, (De*(Q0+(x2+Es)**2*B+(x2+Es)*E0*Y*np.sin(x1+Ds+math.atan(-B/G)))-x2)/Te]
    return dydt

def Plotflow(Xd, Yd, t):
    # Plot phase plane
    DX, DY = dff([Xd, Yd],t)
    DX=DX/np.linalg.norm(DX, ord=2, axis=1, keepdims=True)
    DY=DY/np.linalg.norm(DY, ord=2, axis=1, keepdims=True)
    plt.streamplot(Xd,Yd,DX,DY, color=('gray'), linewidth=0.5, density=0.5, arrowstyle='-|>', arrowsize=1.5)


def PlotAll():
    X = np.linspace(-2, 2, 100)
    Y = np.linspace(-2, 2, 100)
    x1, x2 = np.meshgrid(X, Y)
    # Lyapunov functions
    Vx_liu = ((np.power(x1, 2) + np.power(x2, 2)) * np.log((1 + np.exp((0.00099999993108212948 - 0.016815546900033951 * x1 + 0.011638391762971878 * x2 + np.log((1 + np.exp(( - 0.0089233685284852982 * np.log((1 + np.exp((-0.00099996593780815601 - 0.0001876367605291307 * x1 - 0.0088325617834925652 * x2 + np.log((1 + np.exp((0.011888371780514717 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) + 0.0065671568736433983 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) + 0.019265454262495041 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.0067552910186350346 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) + 0.012529064901173115 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.00047694833483546972 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) + 0.0088121844455599785 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) - 0.016468409448862076 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) - 0.0038936962373554707 * np.log((1 + np.exp((-0.00099993066396564245 + 0.0043319147080183029 * x1 - 0.013298926874995232 * x2 + np.log((1 + np.exp(( - 0.00075120554538443685 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) - 0.0083082234486937523 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) - 0.011939087882637978 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.00074840383604168892 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) + 0.0012859657872468233 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.0044593014754354954 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) + 0.008633587509393692 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) + 0.0018685212126001716 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) - 0.0010189719032496214 * np.log((1 + np.exp((-0.00099983264226466417 + 0.015133693814277649 * x1 - 0.023852638900279999 * x2 + np.log((1 + np.exp(( - 0.018808167427778244 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) - 0.0060026152059435844 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) + 0.015896951779723167 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.009350508451461792 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) + 0.0098053421825170517 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) + 0.014080931432545185 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) - 0.00078678294084966183 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) + 0.0020947621669620275 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) - 5.0922972150146961e-05 * np.log((1 + np.exp((-0.0009996775770559907 + 0.0033023536670953035 * x1 - 0.013609425164759159 * x2 + np.log((1 + np.exp((0.0086254263296723366 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) + 0.0025814985856413841 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) + 0.01253792829811573 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.0037886085920035839 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) - 0.010214579291641712 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.0043692276813089848 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) - 0.0025923827197402716 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) - 0.012752408161759377 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) + 0.002176778856664896 * np.log((1 + np.exp((0.00099971320014446974 + 0.0047912211157381535 * x1 + 0.0043683871626853943 * x2 + np.log((1 + np.exp(( - 0.0042083868756890297 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) + 0.011686102487146854 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) + 0.0055975290015339851 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.014064527116715908 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) + 0.022119564935564995 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.0083208745345473289 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) + 0.0036169637460261583 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) + 0.0028507972601801157 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) + 0.0084678195416927338 * np.log((1 + np.exp((0.00099995441269129515 + 0.010608606040477753 * x1 - 0.0037232863251119852 * x2 + np.log((1 + np.exp(( - 0.0039493674412369728 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) + 0.0054075359366834164 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) - 0.022184561938047409 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) - 0.00048305431846529245 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) - 0.0092125227674841881 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.0049226470291614532 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) + 0.014031935483217239 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) + 0.0025430270470678806 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) + 0.010189613327383995 * np.log((1 + np.exp((0.00099996279459446669 + 0.015482303686439991 * x1 + 0.0036763232201337814 * x2 + np.log((1 + np.exp(( - 0.018266651779413223 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) - 0.0045580556616187096 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) + 0.0080986516550183296 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) + 0.008042619563639164 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) - 0.014012871310114861 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) + 0.0022784043103456497 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) - 0.014326285570859909 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) + 0.011229025200009346 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))) + 0.027983991429209709 * np.log((1 + np.exp((0.00099998724181205034 + 0.010564948432147503 * x1 + 0.017189193516969681 * x2 + np.log((1 + np.exp(( - 0.0070566749200224876 * np.log((1 + np.exp((-0.00099747837521135807 - 0.0016383454203605652 * x1 + 0.018553748726844788 * x2)))) - 0.014909699559211731 * np.log((1 + np.exp((-0.00099706440232694149 - 0.0053644310683012009 * x1 + 0.0061179003678262234 * x2)))) - 0.0042260126210749149 * np.log((1 + np.exp((-0.00099693553056567907 + 0.00023116060765460134 * x1 - 0.017497379332780838 * x2)))) - 0.010359794832766056 * np.log((1 + np.exp((-0.00099609105382114649 + 0.0041518588550388813 * x1 + 0.010799946263432503 * x2)))) + 0.0022058500908315182 * np.log((1 + np.exp((-0.00099572096951305866 + 0.0036362127866595984 * x1 - 0.0055274348706007004 * x2)))) - 0.0010758055141195655 * np.log((1 + np.exp((-0.00098823744338005781 + 0.0098809469491243362 * x1 - 0.014206351712346077 * x2)))) + 0.0081653241068124771 * np.log((1 + np.exp((0.00075001484947279096 + 0.009349077008664608 * x1 - 0.0034048757515847683 * x2)))) - 0.0083195148035883904 * np.log((1 + np.exp((0.00087485823314636946 - 0.011463483795523643 * x1 - 0.0017676379065960646 * x2)))))))))))))))))))))
    Vx_huang = np.tanh((0.10918036848306656 - 0.77330571413040161 * np.tanh((-0.36118981242179871 - 0.52536869049072266 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) - 0.49590176343917847 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) + 0.29747810959815979 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) + 0.30665144324302673 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) + 0.31933686137199402 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) + 0.27512797713279724 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) - 0.3600175678730011 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) + 0.72186392545700073 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) - 0.78278136253356934 * np.tanh((-0.36052441596984863 - 0.52633035182952881 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) - 0.49262541532516479 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) + 0.30357253551483154 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) + 0.29739978909492493 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) + 0.32872235774993896 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) + 0.27255794405937195 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) - 0.34981915354728699 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) + 0.71734005212783813 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) - 0.72887146472930908 * np.tanh((-0.32838696241378784 - 0.45968988537788391 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) - 0.44915956258773804 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) + 0.29851701855659485 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) + 0.28131279349327087 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) + 0.33526656031608582 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) + 0.27219778299331665 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) - 0.364845871925354 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) + 0.74866706132888794 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) + 0.76740562915802002 * np.tanh((0.35369181632995605 + 0.50718075037002563 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) + 0.48581531643867493 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) - 0.29977190494537354 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) - 0.31133216619491577 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) - 0.34481790661811829 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) - 0.27876430749893188 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) + 0.35847550630569458 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) - 0.73561877012252808 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) + 0.76733922958374023 * np.tanh((0.35651373863220215 + 0.51698970794677734 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) + 0.4893079400062561 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) - 0.29743924736976624 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) - 0.31467127799987793 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) - 0.3337441086769104 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) - 0.28548154234886169 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) + 0.3666459321975708 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) - 0.74034988880157471 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) + 0.77630335092544556 * np.tanh((0.36180576682090759 + 0.51970213651657104 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) + 0.49138906598091125 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) - 0.29411932826042175 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) - 0.29182648658752441 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) - 0.33562979102134705 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) - 0.28715035319328308 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) + 0.35850498080253601 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) - 0.72390288114547729 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) + 0.7755657434463501 * np.tanh((0.3632664680480957 + 0.51119208335876465 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) + 0.50632369518280029 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) - 0.3180614709854126 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) - 0.28187379240989685 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) - 0.33787721395492554 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) - 0.27353999018669128 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) + 0.34597498178482056 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) - 0.71993356943130493 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2)))) + 0.78308457136154175 * np.tanh((0.36771437525749207 + 0.51326829195022583 * np.tanh((-0.59537684917449951 - 0.64387714862823486 * x1 - 0.93164283037185669 * x2)) + 0.51336359977722168 * np.tanh((-0.51111817359924316 - 0.7722780704498291 * x1 + 0.90919351577758789 * x2)) - 0.30010583996772766 * np.tanh((-0.42168530821800232 + 0.03062070719897747 * x1 + 0.0033006919547915459 * x2)) - 0.30061435699462891 * np.tanh((-0.34975579380989075 + 0.046726875007152557 * x1 + 0.00099644309375435114 * x2)) - 0.32099094986915588 * np.tanh((-0.33432945609092712 + 0.056341934949159622 * x1 + 0.0018638845067471266 * x2)) - 0.2763373851776123 * np.tanh((-0.19849973917007446 + 0.11272056400775909 * x1 - 0.0091547667980194092 * x2)) + 0.34378665685653687 * np.tanh((0.42095082998275757 - 0.032731976360082626 * x1 - 0.0037310554180294275 * x2)) - 0.71445006132125854 * np.tanh((0.60744291543960571 - 1.1822382211685181 * x1 + 0.0051266658119857311 * x2))))))
    Vx_zhao = np.tanh((-52.504726785726504 - 0.00015235382306855172 * x1 - 0.0284861009567976 * x2 + np.log((1 + np.exp((1.0518003702163696 * np.log((1 + np.exp((0.046546246856451035 + 0.52292603254318237 * x1 + 0.4703250527381897 * x2 + np.log((1 + np.exp(( - 0.32298517227172852 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) - 0.71422439813613892 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) - 0.73053520917892456 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) - 0.84055995941162109 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) - 0.82141584157943726 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 1.2732880115509033 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 1.3584396839141846 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 1.1856787204742432 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.1610069274902344 * np.log((1 + np.exp((0.57286190986633301 - 0.070504561066627502 * x1 - 0.079078085720539093 * x2 + np.log((1 + np.exp((0.77584391832351685 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.87871307134628296 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.68038362264633179 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.67389285564422607 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.69318318367004395 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.85402369499206543 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.83646893501281738 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.68693727254867554 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.1393857002258301 * np.log((1 + np.exp((0.59491240978240967 - 0.085325963795185089 * x1 - 0.21950648725032806 * x2 + np.log((1 + np.exp((0.79964196681976318 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.90013730525970459 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.69038772583007812 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.69789665937423706 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.67051643133163452 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.8499719500541687 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.85574626922607422 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.69061928987503052 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.1412639617919922 * np.log((1 + np.exp((0.59893149137496948 - 0.030367530882358551 * x1 - 0.269704669713974 * x2 + np.log((1 + np.exp((0.73089993000030518 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.92244112491607666 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.66087996959686279 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.68856370449066162 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.67365747690200806 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.83799457550048828 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.84713619947433472 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.65158718824386597 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.2375929355621338 * np.log((1 + np.exp((0.60449898242950439 + 0.097058072686195374 * x1 + 0.02443050779402256 * x2 + np.log((1 + np.exp((0.78484880924224854 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.89530140161514282 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.70195621252059937 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.70599097013473511 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.68776160478591919 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.87628090381622314 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.88793820142745972 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.74192720651626587 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.2513099908828735 * np.log((1 + np.exp((0.63619440793991089 + 0.11974078416824341 * x1 - 0.043162412941455841 * x2 + np.log((1 + np.exp((0.78870856761932373 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.90527665615081787 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.67184180021286011 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.65796130895614624 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.66321337223052979 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.89125466346740723 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.87642949819564819 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.70466876029968262 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.209660530090332 * np.log((1 + np.exp((0.65471827983856201 + 0.19797712564468384 * x1 + 0.091534115374088287 * x2 + np.log((1 + np.exp((0.74271470308303833 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.89240515232086182 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.61197882890701294 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.64950042963027954 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.60443967580795288 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.87429845333099365 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.8971056342124939 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.6868012547492981 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2)))))))))))) + 1.2033694982528687 * np.log((1 + np.exp((0.68143844604492188 - 0.059903047978878021 * x1 - 0.11896679550409317 * x2 + np.log((1 + np.exp((0.73884129524230957 * np.log((1 + np.exp((0.23735855519771576 - 0.87753981351852417 * x1 - 0.10279980301856995 * x2)))) + 0.89667588472366333 * np.log((1 + np.exp((0.27129393815994263 - 0.17003771662712097 * x1 - 1.0998363494873047 * x2)))) + 0.63277429342269897 * np.log((1 + np.exp((0.35130408406257629 - 0.66426515579223633 * x1 - 0.50029045343399048 * x2)))) + 0.65620017051696777 * np.log((1 + np.exp((0.35457885265350342 - 0.62153780460357666 * x1 - 0.60023140907287598 * x2)))) + 0.61083930730819702 * np.log((1 + np.exp((0.38801294565200806 - 0.61618608236312866 * x1 - 0.58160233497619629 * x2)))) + 0.8083573579788208 * np.log((1 + np.exp((0.45925605297088623 + 1.1280100345611572 * x1 + 0.28945070505142212 * x2)))) + 0.76331621408462524 * np.log((1 + np.exp((0.45979830622673035 + 0.51894867420196533 * x1 + 1.1521776914596558 * x2)))) + 0.6674802303314209 * np.log((1 + np.exp((0.56689083576202393 + 0.23303534090518951 * x1 + 0.81134271621704102 * x2))))))))))))))))))
    Vx_lqr = 0.5341 * x1 ** 2 - 0.0485 * 2 * x1 * x2 + 5.7459 * x2 ** 2
    Vx_sos4 = 0.9545*x1**4 - 0.05288*x1**3*x2 + 0.0004552*x1**3 + 0.7807*x1**2*x2**2 + 0.002253*x1**2*x2 + 0.0002112*x1**2 - 0.01547*x1*x2**3 + 0.001068*x1*x2**2 - 0.0005173*x1*x2 + 1.746*x2**4 + 0.004474*x2**3 + 0.004106*x2**2
    Vx_sos6 = 0.5646*x1**6 - 0.05499*x1**5*x2 - 1.101e-5*x1**5 + 0.5191*x1**4*x2**2 - 0.0003012*x1**4*x2 + 0.7184*x1**4 - 0.03188*x1**3*x2**3 - 0.001964*x1**3*x2**2 - 0.06244*x1**3*x2 + 0.0004712*x1**3 + 0.6024*x1**2*x2**4 - 0.000562*x1**2*x2**3 + 0.5364*x1**2*x2**2 + 0.002154*x1**2*x2 + 4.8e-5*x1**2 - 0.01312*x1*x2**5 - 4.949e-5*x1*x2**4 - 0.01629*x1*x2**3 + 0.0001403*x1*x2**2 - 0.0001184*x1*x2 + 1.631*x2**6 + 0.0001347*x2**5 + 1.52*x2**4 + 0.001754*x2**3 + 0.001041*x2**2
    Vx_sos8 = 0.3778*x1**8 - 0.03581*x1**7*x2 + 0.002921*x1**7 + 0.3504*x1**6*x2**2 + 0.0008087*x1**6*x2 + 0.6056*x1**6 - 0.02744*x1**5*x2**3 + 0.00215*x1**5*x2**2 - 0.04863*x1**5*x2 + 0.0006952*x1**5 + 0.3222*x1**4*x2**4 - 0.0009513*x1**4*x2**3 + 0.3765*x1**4*x2**2 + 0.001507*x1**4*x2 + 0.7388*x1**4 - 0.02772*x1**3*x2**5 - 0.001602*x1**3*x2**4 - 0.01165*x1**3*x2**3 + 0.000996*x1**3*x2**2 - 0.05389*x1**3*x2 + 0.0008822*x1**3 + 0.5202*x1**2*x2**6 - 0.0003123*x1**2*x2**5 + 0.3818*x1**2*x2**4 - 0.001004*x1**2*x2**3 + 0.6055*x1**2*x2**2 + 0.002108*x1**2*x2 + 0.0004204*x1**2 - 0.0207*x1*x2**7 - 0.0007762*x1*x2**6 - 0.0002156*x1*x2**5 - 7.496e-5*x1*x2**4 - 0.001822*x1*x2**3 + 0.001053*x1*x2**2 - 0.001115*x1*x2 + 1.313*x2**8 + 0.000361*x2**7 + 1.125*x2**6 - 0.0008077*x2**5 + 1.553*x2**4 + 0.002388*x2**3 + 0.0104*x2**2
    Vx_sos10 = 0.3341*x1**10 - 0.03202*x1**9*x2 - 0.0004369*x1**9 + 0.2982*x1**8*x2**2 - 0.0001266*x1**8*x2 + 0.431*x1**8 - 0.02753*x1**7*x2**3 + 0.000243*x1**7*x2**2 - 0.04513*x1**7*x2 + 0.0004558*x1**7 + 0.3515*x1**6*x2**4 - 2.023e-5*x1**6*x2**3 + 0.3442*x1**6*x2**2 + 0.0005325*x1**6*x2 + 0.5236*x1**6 - 0.02633*x1**5*x2**5 - 0.001268*x1**5*x2**4 - 0.01138*x1**5*x2**3 - 0.001983*x1**5*x2**2 - 0.0489*x1**5*x2 + 0.0004865*x1**5 + 0.376*x1**4*x2**6 + 8.356e-6*x1**4*x2**5 + 0.3243*x1**4*x2**4 + 0.000199*x1**4*x2**3 + 0.3541*x1**4*x2**2 + 0.000761*x1**4*x2 + 0.7033*x1**4 - 0.03224*x1**3*x2**7 - 0.0003683*x1**3*x2**6 - 0.01298*x1**3*x2**5 - 0.0009224*x1**3*x2**4 - 0.01355*x1**3*x2**3 - 0.000534*x1**3*x2**2 - 0.0476*x1**3*x2 + 0.0005918*x1**3 + 0.5323*x1**2*x2**8 - 1.276e-5*x1**2*x2**7 + 0.4278*x1**2*x2**6 - 0.0002372*x1**2*x2**5 + 0.3474*x1**2*x2**4 + 0.0005029*x1**2*x2**3 + 0.5593*x1**2*x2**2 + 0.001317*x1**2*x2 + 1.311e-5*x1**2 - 0.01891*x1*x2**9 - 0.0003233*x1*x2**8 + 0.0007072*x1*x2**7 - 0.0005245*x1*x2**6 + 0.002909*x1*x2**5 - 0.0005247*x1*x2**4 + 0.0009342*x1*x2**3 + 0.001094*x1*x2**2 - 6.534e-5*x1*x2 + 1.302*x2**10 - 0.0003949*x2**9 + 1.023*x2**8 + 0.000348*x2**7 + 0.9998*x2**6 + 0.0002961*x2**5 + 1.429*x2**4 + 0.001993*x2**3 + 0.0005229*x2**2

    fig = plt.figure(figsize=(4, 4), dpi=300)
    ax = plt.gca()
    # plot direction field
    xd = np.linspace(-2, 2, 100)
    yd = np.linspace(-2, 2, 100)
    Xd, Yd = np.meshgrid(xd, yd)
    t = np.linspace(0, 2, 100)
    Plotflow(Xd, Yd, t)
    ax.contour(x1, x2, Vx_liu - 1.04, 0, linewidths=2, colors='g')  # 0表示需要1个等高线
    ax.contour(x1, x2, Vx_huang - 0.82, 0, linewidths=2, colors='m')
    ax.contour(x1, x2, Vx_zhao - 0.81, 0, linewidths=2, colors='c')
    ax.contour(x1, x2, Vx_lqr - 0.48, 0, linewidths=2, colors='#3C79FD')
    ax.contour(x1, x2, Vx_sos4 - 0.65, 0, linewidths=2, colors='#4d638c')
    ax.contour(x1, x2, Vx_sos6 - 0.65, 0, linewidths=2, colors='#b4442a')
    ax.contour(x1, x2, Vx_sos8 - 0.65, 0, linewidths=2, colors='#34314c')
    ax.contour(x1, x2, Vx_sos10 - 0.65, 0, linewidths=2, colors='#cf9482')
    c1 = ax.contourf(x1, x2, Vx_liu, 8, alpha=0.95, cmap=DarkMint_4.mpl_colormap)
    plt.colorbar(c1)
    # Vaild Region
    Vr = plt.Circle((0, 0), 1, color='r', linewidth=1.5, fill=False)
    Ir = plt.Rectangle((-1, -1), 2, 2, color='b', linewidth=1.5, fill=False)
    ax.add_artist(Vr)
    ax.add_artist(Ir)
    # plt.title('Region of Attraction')
    plt.legend([plt.Rectangle((0, 0), 1, 2, color='g', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='m', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='c', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='#3C79FD', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='#4d638c', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='#b4442a', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='#34314c', fill=False, linewidth=2),
                plt.Rectangle((0, 0), 1, 2, color='#cf9482', fill=False, linewidth=2),
                Vr, Ir],
               [r'$L{V_\theta}\left(x \right)\quad\quad\enspace$', r'$H{V_\theta}\left(x\right)\quad\quad\enspace$', r'$Z{V_\theta}\left(x\right)\quad\quad\enspace$', r'$LQR\quad\quad\enspace$',
                 'SOS4', 'SOS6', 'SOS8', 'SOS10',
                'Valid Region', 'Initial region'], fontsize=12, ncol=1, bbox_to_anchor=(1.23, 0.93))

    plt.xlabel('x1', labelpad=0.5)
    plt.ylabel('x2', labelpad=0.5)
    plt.xticks(np.arange(-2, 2, 0.5))
    plt.yticks(np.arange(-2, 2, 0.5))
    plt.tick_params(pad=0.04)
    plt.savefig('flow.pdf', bbox_inches='tight', pad_inches=0.5)
    # plt.show()

if __name__ == '__main__':
    PlotAll()
